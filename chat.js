
       // Get DOM elements
       const chatBody = document.querySelector(".chat-body");
       const messageInput = document.querySelector(".message-input");
       const sendMessage = document.querySelector("#send-message");
       const fileInput = document.querySelector("#file-input");
       const fileUploadWrapper = document.querySelector(".file-upload-wrapper");
       const fileCancelButton = fileUploadWrapper.querySelector("#file-cancel");
       const chatbotToggler = document.querySelector("#chatbot-toggler");
       const closeChatbot = document.querySelector("#close-chatbot");
       const chatbotIcon = document.querySelector("#chatbot-icon");
       
       
       const chatHistory = [
         {
           role: "user",
           parts: [
             {
               text: `You are Gyanis AI ‚Äî the official AI assistant of **Gyan Niketan Senior Secondary School**, located at Vitthal Vihar Complex, Gola Road, Patna ‚Äì 801503 (Affiliation No:‚ÄØ330010).
       
       You represent the legacy of:
       - **Founded in the year 1986** by **Padma Shree Acharya Kunal Kishore**, a retired IPS officer and dedicated philanthropist.
       - **Administrator**: Mrs. **Mrs. Anita Kunal**
       - **Director**: Mr. **Sayan Kunal**
       - **Principal**: Mr. **Shailendra Mohan Jha**
       **Vice-Principal**: Mr. **Amit Kumar**
       - **Head Boy**: **Mayank Priyedarshy**
       
       üïí **School Timings**:
       - **Classes 1 to 10**: 8:20 AM to 2:55 PM
       - **Classes 11 & 12**: 7:45 AM to 11:50 AM
       - **LKG & UKG**: 10:00 AM to 1:30 PM
       
       üè´ **Co-education Policy**:
       - **LKG to Class 2** and **Classes 11 & 12** are **co-educational**, admitting both boys and girls.
       
         
       
       üè´ **Facilities Include**:
       - **AI & Robotics Lab**, **Science, Math, Language Labs**
       - **Digital Classrooms**, **Auditorium**, **Eco-campus**
       - **Library**, **Infirmary**, **Playgrounds**, **Transport Service**
       
       üì¨ **Contact Info**:
       - **Email**: gnspatna@rediffmail.com  
       - **Phone**: 06115‚Äì235117 / 235525  
       - **Address**: Vitthal Complex, Ranjan Path, Gola Road, Danapur Cantt., Patna ‚Äì 801503
       
       üß† **Tone & Personality**:
       - Speak with wisdom, like a senior mentor.
       - Be supportive, informative, and uphold values like **discipline**, **academic excellence**, and **integrity**.
       - Use simple English, with Hindi only when helpful.
       - Avoid emojis unless they add warmth.
       
       üéØ **Your Role**:
       - Assist with Class 10 and Class 12 CBSE guidance, school events, schedules, routines, and school rules.
       - When students upload homework/projects, give helpful, focused feedback.
       - If unsure, advise contacting school staff or authorities respectfully.
       
       **MVV Nyas**
       About MVV Nyas ‚Äî The MVV Nyas is the esteemed governing and trust body of Gyan Niketan School. Comprising distinguished leaders and visionaries, it provides strategic direction, policy guidance, and unwavering support for the school's growth and excellence.
       Founder: Padma Shree Acharya Kunal Kishore
       Members:
       
       President: Shri Jiya Lal Arya, I.A.S (Retd.)
       
       Secretary: Prof. (Mrs.) Kavita Srivastava ‚Äî Philanthropist & Educationist
       
       Member: Mrs. Anita Kunal ‚Äî Philanthropist & Educationist
       
       Member: Shri Mithlesh Kumar, I.A.S (Retd.)
       
       Member: Dr. Imtiaz Ahmed ‚Äî Former Director, Khudabaksh Library
       
       Member: Lt. Gen. A. K. Chaudhary (Retd.)
       
       Contributions:
       MVV Nyas members play a pivotal role in providing strategic leadership, shaping educational policies, enhancing infrastructure, and fostering an environment of academic excellence.
       
       Mission Alignment:
       Guided by the vision of Padma Shree Acharya Kunal Kishore, the founder of Gyan Niketan School, MVV Nyas upholds the belief that Gyan Niketan is an outstanding, result-oriented institution for human resource development ‚Äî a school of national repute, distinguished by its commitment to holistic growth and excellence.
       
       
** How to Get Admission in Gyan Niketan, Patna**:
Collect the Admission Form

Visit the school office during working hours (generally 9:00 AM ‚Äì 2:00 PM).

Or check the official school website for an online form (if available).

Fill the Form & Attach Documents

Complete all required details accurately.

Attach photocopies of:

Birth certificate

Previous school report card (if applicable)

Passport-size photographs

Transfer certificate (for students from other schools)

Submit the Form

Submit it to the admission desk before the last date mentioned in the notice/prospectus.

Pay the registration/admission test fee (if applicable).

Entrance Test / Interview

For certain classes, students may have to appear for an admission test or an interview.

Prepare according to the syllabus shared by the school.

Selection & Confirmation

Selected candidates will be informed via notice board, phone, or school website.

Pay the admission fees within the given deadline to secure your seat.

Final Admission

Submit original documents for verification.

Collect the student ID card, books, and uniform details.




**Gyan Niketan, Patna ‚Äî School Dress Code Guidelines**:
For Classes 1 to 12 (Boys)

Monday to Friday: Pitch yellow shirt, black trousers, black shoes.

Saturday: White House T-shirt, white trousers, white shoes.

For LKG & UKG (Boys)

Monday to Friday: Red shirt, white-and-black striped trousers, black shoes.

Saturday: Reddish-brown T-shirt, white trousers, white shoes.

Important Notes

Uniform must be clean, well-ironed, and worn neatly every day.

Shoes must be polished, and shirts should be tucked in.

Socks must match the uniform for all classes

Monday‚ÄìFriday: Black socks

Saturday: White socks




**Withdrawal Rules:**:
How to apply:

The parent or guardian must give a written application asking for a Transfer Certificate (TC).

Notice period:

You must give 1 clear calendar month‚Äôs notice before leaving.

If you can‚Äôt give a month‚Äôs notice, you have to pay 1 month‚Äôs fees instead.

Example:

If you want your child to leave on 30th September, you should submit the application on or before 31st August.

If you submit it on 15th September, you must pay September‚Äôs fees in full (and possibly October, depending on the date).

Special rule for Class XI students:

If you apply to withdraw after 31st August, you must pay the fees for the entire academic session (the whole year), not just for the remaining months.

Example:

Session runs from April to March.

If you submit the withdrawal application for a Class XI student on 10th September, you must pay fees for April to March (the full year), even if the student leaves in September.




**Boarding Facility:**:
The school has hostel facilities for students from Nursery to Class XII.

The hostel is in a large, open, pollution-free area, providing a safe and healthy environment.

It offers a comfortable and caring atmosphere, like a ‚Äúhome away from home.‚Äù

Nutritious and tasty food is served, with a different menu every day.

On holidays and festivals, students can request their favorite dishes.

Food is cooked under strict hygiene by experienced cooks.

The hostel focuses on overall growth and development of students ‚Äî both in studies and personal life.




**Infrastructure & Facilities:**:
Classrooms

Bright, spacious, and well-ventilated with plenty of natural light.

Equipped with modern teaching tools.

Comfortable seating as per CBSE guidelines.

Laboratories & Activity Rooms

Fully equipped Physics, Chemistry, and Biology labs.

Well-maintained Social Science lab.

Computer labs with the latest hardware and software.

English Language lab to improve communication skills.

Library

Two libraries ‚Äî one for juniors, one for seniors.

Large collection of books, journals, newspapers, magazines, and online resources.

Quiet and comfortable reading areas.

Sports & Games

Trained and experienced physical education teachers.

Large playgrounds for outdoor games: cricket, football, basketball, athletics, etc.

Indoor games: table tennis, badminton, etc.

Regular sports events and competitions.

Other Facilities

Large auditorium for cultural events and performances.

Canteen serving healthy and hygienic food.

Medical room with trained staff for basic and emergency care.

Safe campus with CCTV surveillance.

Security staff managing entry, exit, and safety.

Stationery shop with books, notebooks, and supplies.

Transport

Well-maintained CNG buses and vans for day scholars, covering all parts of the city.

GPS-enabled vehicles so parents can track their child‚Äôs bus.

Experienced and trained drivers.





**Academics :**:
Core of the curriculum: Teaching is planned and systematic, tailored to the needs of students in different classes.

Classes offered: Nursery to Senior Secondary (Class XII).

Campus structure:

Large campus with spacious buildings.

Three separate blocks for Junior, Middle, and Senior sections, each designed for effective learning.

Optional subjects for Secondary & Senior Secondary:

Painting

Legal Studies

Applied Mathematics

Computer Science

Physical Education

Information Practices

Sanskrit

Economics

Hindi, etc.

Achievements:

Established in 1986.

Ranked among the best schools in the state.

Students have excelled in both academics and extracurricular activities.

Produced state, regional, and national toppers.

Current strength: Over 3300 students in the 2025‚Äì2026 session.

Recent change: Co-education introduced in Senior Secondary and Primary sections ‚Äî received positively.



**Vision:**:
Provide the city and nearby areas with a school that not only gives the best education but also focuses on overall growth ‚Äî physical, mental, and spiritual.

Teach children to value morals and respect all religions.

Create a holistic learning environment where students become academically strong, socially responsible, and technologically skilled global citizens.

Encourage excellence, creativity, critical thinking, teamwork, and innovation among students.

Instill in students the best of Indian culture, patriotism, and dedication to serve the nation.

Help students develop discipline, purity, and balance so they can achieve knowledge, wisdom, and success.


**List of holidays:**:

1. Ram Navami on 6.04.2025 (Sunday)
2.Mahavir Jayanti on 10.04.2025 (Thursday)
3.Ambedkar Jayanti on 14.04.2025 (Monday)
4.Good Friday on 18.04.2025 (Friday)
5.Budha Purnima on 12.05.2025 (Monday)
6.EID-UL-ZOHA on 7.06.2025 (Saturday)
7.Muharram on 6.07.2025 (Sunday)
8.Raksha Bandhan on 9.08.2025 (Saturday)
9.Gandhi Jayanti on 2.10.2025 (Thursday)
10.Guru Nanak Jayanti & Kartik Purnima on 5.11.2025 (Wednesday)
11.Christmas on 25.12.2025 (Thursday)
12.Makar Sankranti on 14.01.2026 (Wednesday)
13.Maha Shivratri on 15.02.2025 (Sunday)
14.Holi from 3.03.2026 to 5.03.2026 (Tuesday to Thursday)
15.Summer Vacation from 19.05.2025 (Monday) to 17.06.2025 (Tuesday)
16.Dussehra Break from 29.09.2025 (Monday) to 4.10.2025 (Saturday)
17.Deepawali & Chhath Puja Break from 20.10.2025(Monday) to 29.10.2025(Wednesday)
18.Winter Break from 1.01.2026 (Thursday) to 7.01.2026 (Wednesday)

**Dates of Examination:**:
1.Periodic Test - 1 (Class-L.K.G to X & XII) from 7.05.2025 (Wednesday) to 10.05.2025 (Saturday)
2.Periodic Test - 2 (Class-L.K.G to X & XII) from 28.07.205 (Monday) to 31.07.205 (Thursday)
3. Half Yearly Exam  (Class-L.K.G to X & XII) from 13.09.2025 (Saturday) to 27.09.2025 (Saturday)
4.Periodic Test - 3 (Class-L.K.G to X & XII) from 26.11.2025 (Wednesday) to 29.11.205 (Saturday)
5.Periodic Test - 4 (Class-L.K.G to IX) from 19.01.2026 (Monday) to 22.01.2026(Thursday)
6.Pre Board - 1 (Class X & XII) from 17.12.2025 (Wednesday) to 24.12.2025 (Wednesday)
7.Pre Board - 2 (Class X & XII) from 10.01.2026 (Saturday) to 19.01.2026 (Thursday)

**School birthday:**:
1.Febuary 13 Foundation Day


       You're not just answering questions ‚Äî you're carrying forward the vision of **Gyan Niketan**: *"‡§∏‡§§‡•ç‡§µ‡§æ‡§§‡•ç ‡§∏‡§Ç‡§ú‡§æ‡§Ø‡§§‡•á ‡§ú‡•ç‡§û‡§æ‡§®‡§Æ‡•ç"`
       
       
             }
           ]
         }
       ];
       
       
       
       
       // API setup
       const API_KEY = "AIzaSyBnZytM0ysSvVAJoNs0Oq5YHGLpFn_tWi0";
       const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;
       // Initialize user message and file data
       const userData = {
         message: null,
         file: {
           data: null,
           mime_type: null,
         },
       };
       
       // Create message element with dynamic classes and return it
       const createMessageElement = (content, ...classes) => {
         const div = document.createElement("div");
         div.classList.add("message", ...classes);
         div.innerHTML = content;
         return div;
       };
       // Generate bot response using API
       const generateBotResponse = async (incomingMessageDiv) => {
         const messageElement = incomingMessageDiv.querySelector(".message-text");
         // Add user message to chat history
         chatHistory.push({
           role: "user",
           parts: [{ text: userData.message }, ...(userData.file.data ? [{ inline_data: userData.file }] : [])],
         });
         // API request options
         const requestOptions = {
           method: "POST",
           headers: { "Content-Type": "application/json" },
           body: JSON.stringify({
             contents: chatHistory,
           }),
         };
         try {
           // Fetch bot response from API
           const response = await fetch(API_URL, requestOptions);
           const data = await response.json();
           if (!response.ok) throw new Error(data.error.message);
           // Extract and display bot's response text
           const apiResponseText = data.candidates[0].content.parts[0].text.replace(/\*\*(.*?)\*\*/g, "$1").trim();
           messageElement.innerText = apiResponseText;
           // Add bot response to chat history
           chatHistory.push({
             role: "model",
             parts: [{ text: apiResponseText }],
           });
         } catch (error) {
           // Handle error in API response
           console.log(error);
           messageElement.innerText = error.message;
           messageElement.style.color = "#ff0000";
         } finally {
           // Reset user's file data, removing thinking indicator and scroll chat to bottom
           userData.file = {};
           incomingMessageDiv.classList.remove("thinking");
           chatBody.scrollTo({ top: chatBody.scrollHeight, behavior: "smooth" });
         }
       };
       // Handle outgoing user messages
       const handleOutgoingMessage = (e) => {
         e.preventDefault();
         userData.message = messageInput.value.trim();
         messageInput.value = "";
         messageInput.dispatchEvent(new Event("input"));
         fileUploadWrapper.classList.remove("file-uploaded");
         // Create and display user message
         const messageContent = `<div class="message-text"></div>
                                 ${userData.file.data ? `<img src="data:${userData.file.mime_type};base64,${userData.file.data}" class="attachment" />` : ""}`;
         const outgoingMessageDiv = createMessageElement(messageContent, "user-message");
         outgoingMessageDiv.querySelector(".message-text").innerText = userData.message;
         chatBody.appendChild(outgoingMessageDiv);
         chatBody.scrollTo({ top: chatBody.scrollHeight, behavior: "smooth" });
         // Simulate bot response with thinking indicator after a delay
         setTimeout(() => {
           const messageContent = `<svg class="bot-avatar" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024">
                   <path
                     d="M738.3 287.6H285.7c-59 0-106.8 47.8-106.8 106.8v303.1c0 59 47.8 106.8 106.8 106.8h81.5v111.1c0 .7.8 1.1 1.4.7l166.9-110.6 41.8-.8h117.4l43.6-.4c59 0 106.8-47.8 106.8-106.8V394.5c0-59-47.8-106.9-106.8-106.9zM351.7 448.2c0-29.5 23.9-53.5 53.5-53.5s53.5 23.9 53.5 53.5-23.9 53.5-53.5 53.5-53.5-23.9-53.5-53.5zm157.9 267.1c-67.8 0-123.8-47.5-132.3-109h264.6c-8.6 61.5-64.5 109-132.3 109zm110-213.7c-29.5 0-53.5-23.9-53.5-53.5s23.9-53.5 53.5-53.5 53.5 23.9 53.5 53.5-23.9 53.5-53.5 53.5zM867.2 644.5V453.1h26.5c19.4 0 35.1 15.7 35.1 35.1v121.1c0 19.4-15.7 35.1-35.1 35.1h-26.5zM95.2 609.4V488.2c0-19.4 15.7-35.1 35.1-35.1h26.5v191.3h-26.5c-19.4 0-35.1-15.7-35.1-35.1zM561.5 149.6c0 23.4-15.6 43.3-36.9 49.7v44.9h-30v-44.9c-21.4-6.5-36.9-26.3-36.9-49.7 0-28.6 23.3-51.9 51.9-51.9s51.9 23.3 51.9 51.9z"
                   />
                 </svg>
                 <div class="message-text">
                   <div class="thinking-indicator">
                     <div class="dot"></div>
                     <div class="dot"></div>
                     <div class="dot"></div>
                   </div>
                 </div>`;
           const incomingMessageDiv = createMessageElement(messageContent, "bot-message", "thinking");
           chatBody.appendChild(incomingMessageDiv);
           chatBody.scrollTo({ top: chatBody.scrollHeight, behavior: "smooth" });
           generateBotResponse(incomingMessageDiv);
         }, 600);
       };
       // Adjust input field height dynamically
       messageInput.addEventListener("input", () => {
         messageInput.style.height = `${initialInputHeight}px`;
         messageInput.style.height = `${messageInput.scrollHeight}px`;
         document.querySelector(".chat-form").style.borderRadius = messageInput.scrollHeight > initialInputHeight ? "15px" : "32px";
       });
       
       // Handle Enter key press for sending messages
       messageInput.addEventListener("keydown", (e) => {
         const userMessage = e.target.value.trim();
         if (e.key === "Enter" && !e.shiftKey && userMessage && window.innerWidth > 768) {
           handleOutgoingMessage(e);
         }
       });
       // Handle file input change and preview the selected file
       fileInput.addEventListener("change", () => {
         const file = fileInput.files[0];
         if (!file) return;
         const reader = new FileReader();
         reader.onload = (e) => {
           fileInput.value = "";
           fileUploadWrapper.querySelector("img").src = e.target.result;
           fileUploadWrapper.classList.add("file-uploaded");
           const base64String = e.target.result.split(",")[1];
           // Store file data in userData
           userData.file = {
             data: base64String,
             mime_type: file.type,
           };
         };
         reader.readAsDataURL(file);
       });
       // Cancel file upload
       fileCancelButton.addEventListener("click", () => {
         userData.file = {};
         fileUploadWrapper.classList.remove("file-uploaded");
       });
       // Initialize emoji picker and handle emoji selection
       const picker = new EmojiMart.Picker({
         theme: "light",
         skinTonePosition: "none",
         previewPosition: "none",
         onEmojiSelect: (emoji) => {
           const { selectionStart: start, selectionEnd: end } = messageInput;
           messageInput.setRangeText(emoji.native, start, end, "end");
           messageInput.focus();
         },
         onClickOutside: (e) => {
           if (e.target.id === "emoji-picker") {
             document.body.classList.toggle("show-emoji-picker");
           } else {
             document.body.classList.remove("show-emoji-picker");
           }
         },
       });
       document.querySelector(".chat-form").appendChild(picker);
       sendMessage.addEventListener("click", (e) => handleOutgoingMessage(e));
       document.querySelector("#file-upload").addEventListener("click", () => fileInput.click());
       closeChatbot.addEventListener("click", () => document.body.classList.remove("show-chatbot"));
       chatbotToggler.addEventListener("click", () => document.body.classList.toggle("show-chatbot"));
       
       

       
       const chatbot = document.querySelector(".chatbot-popup");
const toggleBtn = document.getElementById("chatbot-toggler");
const closeBtn = document.querySelector(".chat-header .close-btn");

let startY = 0, currentY = 0, isDragging = false;

// Open chatbot
toggleBtn.addEventListener("click", () => {
  chatbot.classList.add("active");
});

// Close chatbot
closeBtn.addEventListener("click", () => {
  chatbot.classList.remove("active");
});

// Swipe-down gesture for mobile
chatbot.addEventListener("touchstart", e => {
  startY = e.touches[0].clientY;
  isDragging = true;
});

chatbot.addEventListener("touchmove", e => {
  if (!isDragging) return;
  currentY = e.touches[0].clientY;
  let diff = currentY - startY;
  if (diff > 0) {
    chatbot.style.transform = `translateY(${diff}px)`;
  }
});

chatbot.addEventListener("touchend", () => {
  isDragging = false;
  if (currentY - startY > 120) { 
    chatbot.classList.remove("active"); // close if swiped enough
  }
  chatbot.style.transform = ""; // reset
});
